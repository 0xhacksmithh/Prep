# 51. What is SQL Injection in APIs?

âœ… Answer

SQL Injection happens when user input is directly concatenated into SQL queries.

### âŒ Vulnerable Code

```
SELECT * FROM users WHERE email = '${email}'
```

### âš ï¸ Attack

```
email = ' OR 1=1 --
```

### ğŸ“Š Diagram

```
Input â†’ SQL Query â†’ Database Compromise
```

### ğŸ” Prevention

- Prepared statements

- ORM query builders

- Input validation

# 52. What is NoSQL Injection?

âœ… Answer

Occurs when user input manipulates NoSQL queries (MongoDB, etc.).

### âŒ Vulnerable Example

User.findOne({ email: req.body.email })

### âš ï¸ Attack Payload

```
{ "email": { "$ne": null } }
```

### ğŸ“Š Diagram

```
JSON Input â†’ Query Object â†’ Bypass Auth
```

### ğŸ” Prevention

- Strict schema validation

- Disallow operators ($ne, $gt)

- Use mongoose.Schema

# 53. What is Command Injection?

âœ… Answer

Attacker executes **system commands** via unsanitized input.

### âŒ Vulnerable Code

```
exec(`ping ${ip}`)
```

### âš ï¸ Attack

```
127.0.0.1 && rm -rf /
```

### ğŸ“Š Diagram

```
Input â†’ Shell Command â†’ System Access
```

### ğŸ” Prevention

- Avoid shell execution

- Use allowlists

- Escape inputs

# 54. What is XSS in APIs?

âœ… Answer

APIs enable XSS by storing or returning unescaped scripts.

### âš ï¸ Example

```
<script>alert(1)</script>
```

### ğŸ“Š Diagram

```
API â†’ Stored Script â†’ Browser Execution
```

### ğŸ” Prevention

- Output encoding

- Content Security Policy

- Never trust stored input

# 55. What is CSRF? Is CSRF applicable to APIs?

âœ… Answer

CSRF tricks a userâ€™s browser into making authenticated requests.

### ğŸ“Š Diagram

```
Victim Browser â†’ Auth Cookie â†’ API
```

### ğŸ” Applicability

| API Type     | CSRF Risk |
| ------------ | --------- |
| Cookie-based | âœ… Yes    |
| Token-based  | âŒ No     |

### ğŸ” Prevention

- CSRF tokens

- SameSite cookies

- Use Authorization header

# 56. What is SSRF (Server-Side Request Forgery)?

âœ… Answer

SSRF forces server to make internal or cloud requests.

### âš ï¸ Attack

http://169.254.169.254/latest/meta-data

### ğŸ“Š Diagram

```
User Input â†’ Server â†’ Internal Network
```

### ğŸ” Prevention

- URL allowlists

- Block internal IP ranges

- Disable redirects

# 57. What is API fuzzing?

âœ… Answer

Automated testing with random or malformed inputs.

### ğŸ“Š Diagram

```
Fuzzer â†’ API â†’ Unexpected Behavior
```

### ğŸ” Benefit

- Finds crashes

- Finds validation bugs

# 58. What is a replay attack?

âœ… Answer

Attacker reuses captured valid requests.

### ğŸ“Š Diagram

```
Captured Token â†’ Replay â†’ Unauthorized Action
```

### ğŸ” Prevention

- Nonces

- Timestamps

- Short token expiry

# 59. What is a brute-force attack?

âœ… Answer

Repeated attempts to guess credentials or tokens.

### ğŸ“Š Diagram

```
Attacker â†’ Many Requests â†’ Success
```

### ğŸ” Prevention

- Rate limiting

- CAPTCHA

- Account lockout

# 60. What is credential stuffing?

âœ… Answer

Using leaked credentials from other breaches.

### ğŸ“Š Diagram

```
Leaked Email+Password â†’ API Login
```

### ğŸ” Prevention

- MFA

- Rate limiting

- Breach password detection

### ğŸ¯ Interview-Ready Summary (51â€“60)

- Injection â‰  only SQL

- CSRF matters only with cookies

- SSRF = cloud killer

- Rate limiting saves lives
