# 41. What is Horizontal Privilege Escalation?

âœ… Answer

Occurs when a user accesses another userâ€™s resources at the same privilege level.

### ğŸ“Š Example

```
User A accesses /users/2/orders
```

### ğŸ“Š Diagram

```
User A (id=1)
   â†“
Access Order (owner=2) âŒ
```

### ğŸ” Prevention

- Always verify resource ownership

- Never trust IDs from client

# 42. What is Vertical Privilege Escalation?

âœ… Answer

Occurs when a user gains higher privileges than assigned.

### ğŸ“Š Example

```
User changes role=user â†’ admin
```

### ğŸ“Š Diagram

```
User
 â†“
Admin Endpoint âŒ
```

### ğŸ” Prevention

- Server-side role checks

- Block role updates from client input

# 43. How do you prevent IDOR (Insecure Direct Object Reference)?

âœ… Answer

IDOR happens when users can access objects by **guessable IDs.**

### ğŸ“Š Example

```
GET /orders/101
GET /orders/102
```

### ğŸ“Š Diagram

```
Request â†’ ID â†’ Authorization Check
                 â†“
               Allow / Deny
```

### ğŸ” Prevention Checklist

- Resource-level authorization

- Use UUIDs

- Avoid exposing sequential IDs

# 44. What is resource-level authorization?

âœ… Answer

Authorization checks are done per resource instance, not per endpoint.

### ğŸ“Š Example

Can THIS user update THIS post?

### ğŸ“Š Diagram

```
User â†’ Owns Resource? â†’ Yes/No
```

### ğŸ” Interview Gold Line

Endpoint-level auth is insufficient.

# 45. How do you authorize microservices?

âœ… Answer

Microservices must authenticate and authorize each other.

### ğŸ“Š Common Approaches

- mTLS

- JWT with service identity

- API Gateway

### ğŸ“Š Diagram

```
Service A â†’ Token â†’ Service B
```

### ğŸ” Best Practice

Never trust internal network by default (Zero Trust).

# 46. What is OWASP API Top 10?

âœ… Answer

Top 10 most critical API security risks.

### ğŸ“Œ Top Ones

- BOLA

- Broken Auth

- Excessive Data Exposure

- Mass Assignment

### ğŸ“Š Diagram

```
API â†’ OWASP Risk Areas
```

### ğŸ” Interview Expectation

You must know BOLA = #1

# 47. What is Broken Object Level Authorization (BOLA)?

âœ… Answer

When API does not verify if user can access a specific object.

### ğŸ“Š Example

```
/users/{userId}
```

### ğŸ“Š Diagram

```
User â†’ Object ID â†’ No Check â†’ Data Leak
```

### ğŸ” Fix

Always check ownership or permission.

# 48. What is Broken Authentication?

âœ… Answer

Flaws in auth allow attackers to impersonate users.

### ğŸ“Š Examples

- Weak passwords

- Token not expired

- Missing MFA

### ğŸ“Š Diagram

```
Attacker â†’ Stolen Token â†’ Access
```

### ğŸ” Prevention

- Strong password policies

- Short-lived tokens

- MFA

# 49. What is Excessive Data Exposure?

âœ… Answer

API returns **more data than needed**, relying on client to filter.

### ğŸ“Š Example

```
Returns passwordHash, internalId
```

### ğŸ“Š Diagram

```
Database â†’ Full Object â†’ Client âŒ
```

### ğŸ” Fix

- Use DTOs

- Explicit response schemas

# 50. What is Mass Assignment?

âœ… Answer

Client updates **fields it shouldnâ€™t be allowed to.**

### ğŸ“Š Example

```
PATCH /users
{ "role": "admin" }
```

### ğŸ“Š Diagram

```
Client Input â†’ Auto Bind â†’ Privilege Escalation
```

### ğŸ” Prevention

- Whitelist fields

- Disable auto-binding

- Validate input strictly

### ğŸ¯ Interview-Ready Summary (41â€“50)

- **IDOR & BOLA = #1 API risk**

- Always authorize per resource

- Never trust internal services

- Validate input and output
