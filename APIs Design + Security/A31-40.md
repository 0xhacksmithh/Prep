# 31. What is RBAC (Role-Based Access Control)?

âœ… Answer

RBAC grants permissions based on roles, and users are assigned roles.

### ğŸ“Š Example

```
User â†’ Role â†’ Permissions
```

### ğŸ“Š Diagram

```
User
 â†“
[Admin] â”€â”€> create, delete, update
[User]  â”€â”€> read
```

### ğŸ” Pros / Cons

âœ… Easy to manage
âŒ Not flexible for complex rules

# 32. What is ABAC (Attribute-Based Access Control)?

âœ… Answer

ABAC uses **attributes** of user, resource, action, and context.

### ğŸ“Š Example

```
Allow if:
user.role = "manager"
AND resource.owner = user.id
AND time < 6pm
```

### ğŸ“Š Diagram

```
User + Resource + Context
        â†“
      Policy
        â†“
      Decision
```

### ğŸ” Advantage

Highly flexible, fine-grained control

# 33. RBAC vs ABAC

âœ… Comparison
| RBAC | ABAC |
| -------------- | --------------- |
| Role-based | Attribute-based |
| Simple | Complex |
| Static | Dynamic |
| Coarse-grained | Fine-grained |

### ğŸ“Š Diagram

```
RBAC: User â†’ Role â†’ Access
ABAC: Attributes â†’ Policy â†’ Access
```

### ğŸ¯ Interview Tip

Large systems often use **RBAC + ABAC hybrid**

# 34. What is scope-based authorization?

âœ… Answer

Scopes define **what actions a token is allowed to perform.**

### ğŸ“Š Example

```
scope: "user.read user.write"
```

### ğŸ“Š Diagram

```
Token
 â”œâ”€ read:user
 â””â”€ write:user
```

### ğŸ” Used In

OAuth 2.0 APIs

# 35. What are permissions vs roles?

âœ… Answer
| Role | Permission |
| -------------------- | ------------- |
| Group of permissions | Single action |
| admin | user:create |
| manager | order:approve |

### ğŸ“Š Diagram

```
Permission â†’ Role â†’ User
```

### ğŸ” Best Practice

Design permissions first, then group into roles.

# 36. How do you design fine-grained authorization?

âœ… Answer

Use resource-level checks, not just role checks.

### ğŸ“Š Example

```
Can user update THIS order?
```

### ğŸ“Š Diagram

```
User â†’ Resource Ownership â†’ Access Decision
```

### ğŸ” Interview Gold

Authorization must be per resource, not per endpoint.

# 37. What is policy-based access control?

âœ… Answer

Access decisions are made using policies, not hardcoded logic.

# ğŸ“Š Example Policy

```
ALLOW if role=admin OR owner=true
```

### ğŸ“Š Diagram

```
Request
 â†“
Policy Engine
 â†“
Allow / Deny
```

### ğŸ” Tools

- OPA (Open Policy Agent)

- AWS IAM

# 38. What is the Principle of Least Privilege?

âœ… Answer

Users/services get **minimum access needed.**

### ğŸ“Š Diagram

```
User â†’ Minimal Permissions â†’ Task
```

### ğŸ” Why Important?

- Limits blast radius

- Reduces insider threat

# 39. How do you secure admin APIs?

âœ… Answer

Admin APIs need **extra layers of protection.**

### ğŸ“Œ Techniques

- Separate domain/subdomain

- Strong authentication (MFA)

- IP allowlist

- Audit logging

### ğŸ“Š Diagram

```
Admin â†’ MFA â†’ Admin API
```

### ğŸ” Interview Tip

Never expose admin APIs publicly.

# 40. How do you implement multi-tenant authorization?

âœ… Answer

Each request must be scoped to a tenant.

### ğŸ“Š Example

```
tenant_id from token must match resource.tenant_id
```

### ğŸ“Š Diagram

```
User (Tenant A)
  â†“
Tenant Check
  â†“
Tenant A Data âœ”
Tenant B Data âŒ
```

### ğŸ” Common Bug

Missing tenant check â†’ **data leak**

### ğŸ¯ Interview-Ready Summary (31â€“40)

- RBAC = simple

- ABAC = powerful

- Scopes = token-level control

- Fine-grained auth prevents IDOR

- Least privilege is mandatory
