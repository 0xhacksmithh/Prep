# 91. How do you design audit logging?

âœ… Answer

Audit logs track security-relevant actions, not general logs.

### ðŸ“Š Diagram

```
User Action â†’ Audit Event â†’ Immutable Log Store
```

### ðŸ” What to Log

- Who (user/service)

- What (action)

- When (timestamp)

- Where (IP)

- Result (success/failure)

### ðŸ” Best Practice

Make audit logs **append-only.**

# 92. How do you handle breach detection?

âœ… Answer

Detect breaches using monitoring + alerts, not after users complain.

### ðŸ“Š Diagram

```
Logs â†’ SIEM â†’ Alert â†’ Incident Response
```

### ðŸ” Indicators

- Unusual traffic spikes

- Failed login bursts

- Access pattern anomalies

# 93. What is an API firewall?

âœ… Answer

An API firewall enforces API-specific security rules.

### ðŸ“Š Diagram

```
Client â†’ API Firewall â†’ API
```

### ðŸ” Capabilities

- Schema validation

- Payload inspection

- OWASP API Top 10 protection

# 94. WAF vs API Gateway

âœ… Answer
| WAF | API Gateway |
| ---------------- | ---------------- |
| Layer 7 security | Routing & policy |
| Blocks attacks | Controls traffic |
| Generic | API-aware |

### ðŸ“Š Diagram

```
Client â†’ WAF â†’ API Gateway â†’ API
```

### ðŸ” Interview Tip

They complement each other.

# 95. How do you handle security in GraphQL APIs?

âœ… Answer

GraphQL exposes a single endpoint, increasing risk.

### ðŸ“Š Diagram

```
Single Endpoint â†’ Multiple Resolvers
```

### ðŸ” Controls

- Auth per resolver

- Schema validation

- Disable introspection in prod

# 96. How do you rate limit GraphQL queries?

âœ… Answer

Traditional rate limiting fails because queries vary in cost.

### ðŸ“Š Diagram

```
Query â†’ Cost Analysis â†’ Allow / Reject
```

### ðŸ” Techniques

- Query depth limit

- Query complexity scoring

- Persisted queries

# 97. How do you prevent N+1 attacks securely?

âœ… Answer

N+1 queries cause resource exhaustion.

### ðŸ“Š Diagram

```
1 Query â†’ N DB Calls âŒ
```

### ðŸ” Fix

- DataLoader

- Batch fetching

- Query cost limits

# 98. How do you perform API security testing?

âœ… Answer

Security testing must be continuous.

### ðŸ“Š Diagram

```
Code â†’ SAST â†’ DAST â†’ Pen Test
```

### ðŸ” Tools

- OWASP ZAP

- Burp Suite

- Postman security tests

# 99. How do you handle incident response after a breach?

âœ… Answer

Use a structured incident response plan.

### ðŸ“Š Diagram

```
Detect â†’ Contain â†’ Eradicate â†’ Recover â†’ Review
```

### ðŸ” Key Steps

- Revoke tokens

- Rotate secrets

- Notify stakeholders

- Post-mortem

# 100. How do you design a secure authentication system from scratch?

âœ… Answer (High-Level Design)

### ðŸ“Š Diagram

```
Client
  â†“
Auth (OAuth + OIDC)
  â†“
Token Service
  â†“
API Gateway
  â†“
Services
```

### ðŸ” Core Principles

- OAuth + PKCE

- Short-lived access tokens

- Refresh token rotation

- MFA

- Audit logging

- Zero trust

### ðŸ† FINAL INTERVIEW CHEAT SUMMARY (91â€“100)

- Logs are security artifacts

- Detection > prevention alone

- GraphQL needs extra controls

- Incidents must be rehearsed

- Security is architecture, not middleware
