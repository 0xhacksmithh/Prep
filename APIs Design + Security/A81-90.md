# 81. How do you design secure webhooks?

âœ… Answer

Webhooks are incoming APIs called by third-party services â†’ must be treated as untrusted.

### ğŸ“Š Diagram

```
3rd Party â†’ Webhook Endpoint â†’ Verification â†’ Processing
```

### ğŸ” Best Practices

- HTTPS only

- Signature verification

- Idempotency keys

- IP allowlisting (optional)

# 82. How do you validate webhook signatures?

âœ… Answer

Webhook payloads are signed using a shared secret.

### ğŸ“Š Flow

```
Payload + Secret â†’ HMAC â†’ Signature
```

### ğŸ“Š Diagram

```
Incoming Webhook
   â†“
Recompute Signature
   â†“
Match? â†’ Process : Reject
```

### ğŸ” Interview Tip

Always use constant-time comparison.

# 83. How do you rotate secrets?

âœ… Answer

Secret rotation replaces keys without downtime.

### ğŸ“Š Diagram

```
Old Secret â†’ New Secret â†’ Invalidate Old
```

### ğŸ” Best Practices

- Overlapping validity

- Automated rotation

- Never hardcode secrets

# 84. How do you manage environment secrets?

âœ… Answer

Secrets must be stored outside code.

### ğŸ“Š Diagram

```
App â†’ Secret Manager â†’ Runtime Injection
```

### ğŸ” Tools

- AWS Secrets Manager

- Vault

- Kubernetes Secrets

# 85. How do you handle backward compatibility securely?

âœ… Answer

Old API versions often contain known vulnerabilities.

### ğŸ“Š Diagram

```
v1 (deprecated) â†’ v2 (secure)
```

### ğŸ” Best Practices

- Version expiration

- Patch old versions

- Monitor legacy usage

# 86. How do you secure microservice-to-microservice communication?

âœ… Answer

Services must authenticate and authorize each other.

### ğŸ“Š Diagram

```
Service A â†’ mTLS / JWT â†’ Service B
```

### ğŸ” Best Practices

- mTLS

- Service identities

- Zero-trust networking

# 87. mTLS vs JWT between services

âœ… Answer
| mTLS | JWT |
| ---------------- | --------------- |
| Transport-level | App-level |
| Strong identity | Flexible claims |
| Harder to manage | Easier rotation |

### ğŸ“Š Diagram

```
mTLS: Cert â†” Cert
JWT: Token â†’ Verify
```

### ğŸ” Interview Answer

Use both together.

# 88. How do you secure public vs private APIs?

âœ… Answer
| Public API | Private API |
| ------------- | ---------------- |
| Auth required | Network + Auth |
| Rate limited | Strict allowlist |
| Exposed | Internal only |

### ğŸ“Š Diagram

```
Public â†’ Gateway â†’ API
Private â†’ Internal Network
```

# 89. How do you design auth for mobile apps?

âœ… Answer

Mobile apps are untrusted clients.

### ğŸ“Š Diagram

```
Mobile App â†’ OAuth + PKCE â†’ API
```

### ğŸ” Best Practices

- OAuth Authorization Code + PKCE

- No secrets in app

- Secure token storage

# 90. How do you prevent token theft?

âœ… Answer

Tokens can be stolen via XSS, MITM, logs.

ğŸ“Š Diagram

```
Attack â†’ Token Theft â†’ Replay
```

### ğŸ” Prevention

- HTTPS everywhere

- HTTP-only cookies

- Short-lived tokens

- Token binding (optional)

### ğŸ¯ Interview-Ready Summary (81â€“90)

- Webhooks must be authenticated

- Secrets must rotate

- Zero trust applies internally too

- Mobile apps â‰  trusted

- Token theft mitigation is layered
